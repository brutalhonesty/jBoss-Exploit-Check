<?php
/* Author: Adam Schodde aaschodd[at]asu[dot]edu
 * This script will grab the names of the known jBoss Projects and query them on exploit-db for known vulnerabilties.
 * It will output the vulnerabilties to their own text files for review later.
 * The script can be found @ http://py1337.get-root.com/ or e-mail RuSH4ck3R[at]gmail[dot]com
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Library General Public
 * License as published by the Free Software Foundation; either
 * version 2 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Library General Public License for more details.
 *
 * You should have received a copy of the GNU Library General Public
 * License along with this library; if not, write to the
 * Free Software Foundation, Inc., 59 Temple Place - Suite 330,
 * Boston, MA 02111-1307, USA.
 */

//Include Libraries
include("../library/LIB_parse.php");
include("../library/LIB_http.php");
include("../library/LIB_simple_spider.php");
include("../library/LIB_resolve_addresses.php");
include("../library/LIB_download_images.php");

$base_url = "http://www.jboss.org/projects";

//Arrays
$projectNames = array();

$web_page = http_get($target=$base_url, $referrer="J.A.R.V.I.S. Web Bot");

$name_excl = parse_array($web_page['FILE'], "</span>", "</a>");

for($i = 0; $i < count($name_excl); $i++)
{
	$aRemove = strstr($name_excl[$i], "</a>", true);
	$replace = str_replace(" ", "", $aRemove);
	$spanSubRemove = substr($replace, 7);
	array_push($projectNames, $spanSubRemove);
}
array_shift($projectNames);
//var_dump($projectNames);
for($x = 0; $x < count($projectNames); $x++)
{
	$command = "python getsploits.py -o ".$projectNames[$x].".txt"." --type any \"".$projectNames[$x]."\"";
	system($command);
}
?>
